<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hiragana Flash Drill</title>
    <style>
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial,
          sans-serif;
        margin: 24px;
        line-height: 1.2;
      }
      header {
        display: flex;
        gap: 12px;
        align-items: center;
        flex-wrap: wrap;
        margin-bottom: 16px;
      }
      button {
        padding: 10px 14px;
        border: 1px solid #ccc;
        border-radius: 10px;
        background: white;
        cursor: pointer;
      }
      button:hover {
        background: #f6f6f6;
      }
      label {
        display: inline-flex;
        gap: 8px;
        align-items: center;
        user-select: none;
      }
      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
        gap: 12px;
      }
      .card {
        border: 1px solid #e3e3e3;
        border-radius: 16px;
        padding: 16px 12px;
        text-align: center;
        background: #fff;
      }
      .kana {
        font-size: 44px;
        margin-bottom: 8px;
      }
      .romaji {
        font-size: 16px;
        opacity: 0.75;
        visibility: hidden;
      }
      .show-romaji .romaji {
        visibility: visible;
      }
      .footer {
        margin-top: 18px;
        font-size: 14px;
        opacity: 0.8;
      }
      .count {
        font-weight: 600;
      }
    </style>
  </head>
  <body>
    <header>
      <button id="reroll">Generate 25</button>

      <label>
        <input id="showRomaji" type="checkbox" />
        Show romaji
      </label>

      <label>
        <input id="includeDakuten" type="checkbox" />
        Include dakuten/handakuten (が, ぱ, etc.)
      </label>

      <span class="count" id="count"></span>
    </header>

    <main id="grid" class="grid"></main>

    <div class="footer">
      Tip: say each sound out loud. If it takes &gt;1 second, mark it as “needs
      work.” Press <b>R</b> to re-roll, <b>Space</b> to toggle romaji.
    </div>

    <script>
      // Core hiragana (gojūon + small ya/yu/yo + small tsu + n)
      const BASE = [
        ["あ", "a"],
        ["い", "i"],
        ["う", "u"],
        ["え", "e"],
        ["お", "o"],
        ["か", "ka"],
        ["き", "ki"],
        ["く", "ku"],
        ["け", "ke"],
        ["こ", "ko"],
        ["さ", "sa"],
        ["し", "shi"],
        ["す", "su"],
        ["せ", "se"],
        ["そ", "so"],
        ["た", "ta"],
        ["ち", "chi"],
        ["つ", "tsu"],
        ["て", "te"],
        ["と", "to"],
        ["な", "na"],
        ["に", "ni"],
        ["ぬ", "nu"],
        ["ね", "ne"],
        ["の", "no"],
        ["は", "ha"],
        ["ひ", "hi"],
        ["ふ", "fu"],
        ["へ", "he"],
        ["ほ", "ho"],
        ["ま", "ma"],
        ["み", "mi"],
        ["む", "mu"],
        ["め", "me"],
        ["も", "mo"],
        ["や", "ya"],
        ["ゆ", "yu"],
        ["よ", "yo"],
        ["ら", "ra"],
        ["り", "ri"],
        ["る", "ru"],
        ["れ", "re"],
        ["ろ", "ro"],
        ["わ", "wa"],
        ["を", "wo"],
        ["ん", "n"],
        ["ゃ", "(small) ya"],
        ["ゅ", "(small) yu"],
        ["ょ", "(small) yo"],
        ["っ", "(small) tsu"],
      ];

      // Dakuten/handakuten (optional)
      const DAKUTEN = [
        ["が", "ga"],
        ["ぎ", "gi"],
        ["ぐ", "gu"],
        ["げ", "ge"],
        ["ご", "go"],
        ["ざ", "za"],
        ["じ", "ji"],
        ["ず", "zu"],
        ["ぜ", "ze"],
        ["ぞ", "zo"],
        ["だ", "da"],
        ["ぢ", "ji"],
        ["づ", "zu"],
        ["で", "de"],
        ["ど", "do"],
        ["ば", "ba"],
        ["び", "bi"],
        ["ぶ", "bu"],
        ["べ", "be"],
        ["ぼ", "bo"],
        ["ぱ", "pa"],
        ["ぴ", "pi"],
        ["ぷ", "pu"],
        ["ぺ", "pe"],
        ["ぽ", "po"],
      ];

      function sampleUnique(arr, n) {
        // Fisher–Yates shuffle copy, then slice
        const copy = arr.slice();
        for (let i = copy.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [copy[i], copy[j]] = [copy[j], copy[i]];
        }
        return copy.slice(0, Math.min(n, copy.length));
      }

      function render() {
        const includeDakuten =
          document.getElementById("includeDakuten").checked;
        const pool = includeDakuten ? BASE.concat(DAKUTEN) : BASE;

        const picks = sampleUnique(pool, 25);

        const grid = document.getElementById("grid");
        grid.innerHTML = "";

        for (const [kana, romaji] of picks) {
          const card = document.createElement("div");
          card.className = "card";

          const k = document.createElement("div");
          k.className = "kana";
          k.textContent = kana;

          const r = document.createElement("div");
          r.className = "romaji";
          r.textContent = romaji;

          card.appendChild(k);
          card.appendChild(r);
          grid.appendChild(card);
        }

        document.getElementById(
          "count"
        ).textContent = `Showing ${picks.length} / ${pool.length}`;
      }

      function syncRomajiVisibility() {
        const show = document.getElementById("showRomaji").checked;
        document.body.classList.toggle("show-romaji", show);
      }

      // Wire up UI
      document.getElementById("reroll").addEventListener("click", render);
      document
        .getElementById("showRomaji")
        .addEventListener("change", syncRomajiVisibility);
      document
        .getElementById("includeDakuten")
        .addEventListener("change", render);

      // Keyboard shortcuts
      window.addEventListener("keydown", (e) => {
        if (e.key === "r" || e.key === "R") render();
        if (e.key === " ") {
          e.preventDefault();
          const cb = document.getElementById("showRomaji");
          cb.checked = !cb.checked;
          syncRomajiVisibility();
        }
      });

      // Initial
      syncRomajiVisibility();
      render();
    </script>
  </body>
</html>
